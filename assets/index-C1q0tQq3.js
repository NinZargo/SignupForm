const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AccountSetup-B5x-UpWv.js","assets/vendor-Bc-sSxl_.js","assets/EventList-DAS0MZzH.js","assets/MySignups-BgnxIuGa.js","assets/ResetPassword-IDr8Jzs_.js","assets/AccessDenied-CF3gYWhc.js","assets/AdminPage-CCZgQZsS.js"])))=>i.map(i=>d[i]);
import{c as N,r,j as e,u as I,a as M,B as p,L as z,b as k,d as A,e as E,D as L,A as F,T as V,f as S,S as W,g as b,I as J,M as q,h as H,P as Z,i as G,k as R,C as Y,l as O,m as U,_ as y,H as $,n as K,o as B,R as Q,p as g,N as w,O as X,q as ee}from"./vendor-Bc-sSxl_.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))l(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&l(c)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();const te="https://jhhbluhsgqykccyivxei.supabase.co",se="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpoaGJsdWhzZ3F5a2NjeWl2eGVpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM1Mzk4MTQsImV4cCI6MjA2OTExNTgxNH0.msu84MPP98SnwIwpf1-JsW5DBDllcyKraONJp9TrQ68",x=N(te,se),D=r.createContext();function ne({children:s}){const[t,a]=r.useState(null),[l,n]=r.useState(null),[o,c]=r.useState(!0);r.useEffect(()=>{(async()=>{const{data:{session:u}}=await x.auth.getSession();if(a(u),u!=null&&u.user){const{data:i}=await x.from("users").select("*").eq("id",u.user.id).single();n(i)}c(!1)})();const{data:{subscription:m}}=x.auth.onAuthStateChange((u,i)=>{a(i),i!=null&&i.user?x.from("users").select("*").eq("id",i.user.id).single().then(({data:f})=>n(f)):n(null)});return()=>m.unsubscribe()},[]);const h={session:t,profile:l,isAdmin:(l==null?void 0:l.is_admin)||!1,loading:o};return e.jsx(D.Provider,{value:h,children:s})}function _(){return r.useContext(D)}function re({children:s}){const t=I(),a=M(),[l,n]=r.useState(!1),{isAdmin:o}=_(),c=async()=>{await x.auth.signOut(),t("/")},h=()=>{n(!l)},v=[{label:"Events",path:"/events"},{label:"MySignups",path:"/mysignups"}],m=o?[...v,{label:"Admin",path:"/admin"}]:v,u=e.jsx(p,{onClick:h,sx:{textAlign:"center"},children:e.jsxs(z,{children:[m.map(i=>e.jsx(k,{disablePadding:!0,children:e.jsx(A,{sx:{textAlign:"center"},onClick:()=>t(i.path),children:e.jsx(E,{primary:i.label})})},i.label)),e.jsx(L,{}),e.jsx(k,{disablePadding:!0,children:e.jsx(A,{sx:{textAlign:"center"},onClick:c,children:e.jsx(E,{primary:"Logout"})})})]})});return e.jsxs(p,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh",width:"100vw",backgroundColor:"#f4f6f8",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cg fill='%23dce4ec' fill-opacity='1'%3E%3Cpolygon fill-rule='evenodd' points='8 4 12 6 8 8 6 12 4 8 0 6 4 4 6 0 8 4'/%3E%3C/g%3E%3C/svg%3E")`},children:[e.jsx(F,{position:"static",sx:{bgcolor:"white",boxShadow:"none",borderBottom:"1px solid #ddd"},children:e.jsxs(V,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:{xs:"10px",sm:"10px 20px"}},children:[e.jsxs(p,{sx:{display:"flex",alignItems:"center",cursor:"pointer",gap:1.5},onClick:()=>t("/events"),children:[e.jsx(p,{component:"img",src:"/BrunelSailingIcon.jpeg",alt:"Brunel Sailing logo",sx:{height:"40px"}}),e.jsx(S,{variant:"h6",component:"div",sx:{fontFamily:"'Helvetica Neue', Arial, sans-serif",fontWeight:"bold",fontSize:"2rem",letterSpacing:-1,color:"#003c71",display:{xs:"none",sm:"block"}},children:"Brunel Sailing"})]}),e.jsxs(p,{sx:{display:{xs:"none",sm:"flex"},alignItems:"center",gap:1},children:[e.jsx(W,{direction:"row",spacing:1,divider:e.jsx(L,{orientation:"vertical",flexItem:!0,sx:{height:"20px",alignSelf:"center"}}),children:m.map(i=>{const f=a.pathname===i.path;return e.jsx(b,{onClick:()=>t(i.path),sx:{color:f?"primary.main":"black",fontWeight:f?"bold":"normal",backgroundColor:f?"action.hover":"transparent",textTransform:"none","&:hover":{backgroundColor:"action.hover"}},children:i.label},i.label)})}),e.jsx(b,{variant:"outlined",color:"error",onClick:c,sx:{textTransform:"none",ml:2},children:"Logout"})]}),e.jsx(J,{color:"inherit","aria-label":"open drawer",edge:"end",onClick:h,sx:{display:{sm:"none"},color:"black"},children:e.jsx(q,{})})]})}),e.jsx(H,{variant:"temporary",open:l,onClose:h,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:"60%"}},children:u}),e.jsx(p,{component:"main",sx:{flexGrow:1,p:{xs:2,sm:3},width:"100%",display:"flex",justifyContent:"center"},children:e.jsx(Z,{elevation:3,sx:{width:"100%",maxWidth:"1200px",backgroundColor:"white",borderRadius:2,p:3},children:s})})]})}const ie="kUIc5Moarxp1c0JtUnPVaATm3eVg3Y1aFGZVNN4L3ZY",ae=async s=>{try{const t=await G.get("https://api.unsplash.com/photos/random",{params:{query:s,orientation:"landscape"},headers:{Authorization:`Client-ID ${ie}`}});return t.data&&t.data.urls?t.data.urls.regular:null}catch(t){return console.error("Error fetching image from Unsplash:",t),null}},oe="/assets/BrunelSailingIcon-AP_PaV4P.jpeg";function le({photographerName:s,photographerUrl:t}){const a="Brunel_Sailing_Signups";return!s||!t?null:e.jsx(p,{sx:{position:"absolute",bottom:8,right:8,backgroundColor:"rgba(0, 0, 0, 0.4)",color:"white",padding:"2px 8px",borderRadius:1,fontSize:"0.75rem"},children:e.jsxs(S,{variant:"caption",children:["Photo by"," ",e.jsx(R,{href:`${t}?utm_source=${a}&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",color:"inherit",children:s})," ","on"," ",e.jsx(R,{href:`https://unsplash.com/?utm_source=${a}&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",color:"inherit",children:"Unsplash"})]})})}const ce=()=>{const[s,t]=r.useState("signin"),[a,l]=r.useState(""),[n,o]=r.useState(""),[c,h]=r.useState(null),[v,m]=r.useState(""),u=I(),[i,f]=r.useState({imageUrl:"",photographerName:"",photographerUrl:""});r.useEffect(()=>{async function j(){const d=await ae("sailing race");d&&f(d)}j()},[]);const T=async j=>{if(j.preventDefault(),h(null),m(""),s==="signin"){const{data:d,error:C}=await x.auth.signInWithPassword({email:a,password:n});if(C)h(C.message);else if(d.user){const{data:P}=await x.from("users").select("student_number").eq("id",d.user.id).single();P&&P.student_number?u("/events"):u("/setup")}}else if(s==="signup"){const{error:d}=await x.auth.signUp({email:a,password:n});d?h(d.message):m("Signup successful! Check your email to confirm.")}else if(s==="forgot"){const{error:d}=await x.auth.resetPasswordForEmail(a,{redirectTo:"https://ninzargo.github.io/SignUpForm/#/"});d?h(d.message):m("Password reset email sent! Check your inbox.")}};return e.jsxs(Y,{maxWidth:"false",sx:{width:"100vw",height:"100vh",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",backgroundImage:`url(${i.imageUrl})`,backgroundSize:"cover",backgroundPosition:"center",transition:"background-image 1s ease-in-out"},children:[e.jsxs(p,{sx:{p:4,boxShadow:5,borderRadius:2,maxWidth:400,width:"100%",backgroundColor:"rgba(255, 255, 255, 0.95)",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(p,{component:"img",src:oe,alt:"Brunel Sailing Logo",sx:{height:80,width:80,mb:2,borderRadius:"50%"}}),e.jsx(S,{variant:"h4",gutterBottom:!0,children:s==="signup"?"Sign Up":s==="signin"?"Sign In":"Reset Password"}),c&&e.jsx(O,{severity:"error",children:c}),v&&e.jsx(O,{severity:"success",children:v}),e.jsxs("form",{onSubmit:T,children:[e.jsx(U,{fullWidth:!0,label:"Email",variant:"outlined",margin:"normal",value:a,onChange:j=>l(j.target.value),required:!0}),s!=="forgot"&&e.jsx(U,{fullWidth:!0,label:"Password",type:"password",variant:"outlined",margin:"normal",value:n,onChange:j=>o(j.target.value),required:!0}),e.jsx(b,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:s==="signup"?"Sign Up":s==="signin"?"Sign In":"Send Reset Link"})]}),e.jsxs(S,{variant:"body2",sx:{mt:2},children:[s==="signin"&&e.jsxs(e.Fragment,{children:["Don't have an account? ",e.jsx(b,{variant:"text",onClick:()=>t("signup"),children:"Sign Up"}),e.jsx("br",{}),e.jsx(b,{variant:"text",onClick:()=>t("forgot"),children:"Forgot Password?"})]}),s==="signup"&&e.jsxs(e.Fragment,{children:[" Already have an account? ",e.jsx(b,{variant:"text",onClick:()=>t("signin"),children:"Sign In"})," "]}),s==="forgot"&&e.jsxs(e.Fragment,{children:[" Remembered your password? ",e.jsx(b,{variant:"text",onClick:()=>t("signin"),children:"Sign In"})," "]})]})]}),e.jsx(le,{photographerName:i.photographerName,photographerUrl:i.photographerUrl})]})},ue=r.lazy(()=>y(()=>import("./AccountSetup-B5x-UpWv.js"),__vite__mapDeps([0,1]))),de=r.lazy(()=>y(()=>import("./EventList-DAS0MZzH.js"),__vite__mapDeps([2,1]))),pe=r.lazy(()=>y(()=>import("./MySignups-BgnxIuGa.js"),__vite__mapDeps([3,1]))),he=r.lazy(()=>y(()=>import("./ResetPassword-IDr8Jzs_.js"),__vite__mapDeps([4,1]))),ge=r.lazy(()=>y(()=>import("./AccessDenied-CF3gYWhc.js"),__vite__mapDeps([5,1]))),xe=r.lazy(()=>y(()=>import("./AdminPage-CCZgQZsS.js"),__vite__mapDeps([6,1]))),me=()=>{const{session:s,profile:t,loading:a}=_();return a?e.jsx(p,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(B,{})}):s?t!=null&&t.name?e.jsx(re,{children:e.jsx(X,{})}):e.jsx(w,{to:"/setup",replace:!0}):e.jsx(w,{to:"/",replace:!0})};function fe(){const{isAdmin:s}=_(),t=I();return r.useEffect(()=>{new URLSearchParams(window.location.hash.substring(1)).has("error_description")&&t("/access-denied")},[t]),e.jsxs(Q,{children:[e.jsx(g,{path:"/",element:e.jsx(ce,{})}),e.jsx(g,{path:"/setup",element:e.jsx(ue,{})}),e.jsx(g,{path:"/update-password",element:e.jsx(he,{})}),e.jsx(g,{path:"/access-denied",element:e.jsx(ge,{})}),e.jsxs(g,{element:e.jsx(me,{}),children:[e.jsx(g,{path:"/events",element:e.jsx(de,{})}),e.jsx(g,{path:"/mysignups",element:e.jsx(pe,{})}),s&&e.jsx(g,{path:"/admin",element:e.jsx(xe,{})})]}),e.jsx(g,{path:"*",element:e.jsx(w,{to:"/events",replace:!0})})]})}function je(){return e.jsxs($,{children:[e.jsx(K,{}),e.jsx(ne,{children:e.jsx(r.Suspense,{fallback:e.jsx(p,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(B,{})}),children:e.jsx(fe,{})})})]})}ee.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(je,{})}));export{ae as f,x as s,_ as u};
