const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AccountSetup-CXfkDri1.js","assets/vendor-mLxMphKg.js","assets/EventList-Cde2Su0H.js","assets/EventSignup-hg9Abliz.js","assets/MySignups-DJ1IafsB.js","assets/ResetPassword-Bgs2bUne.js","assets/AccessDenied-Dr3UKXIH.js","assets/AdminPage-C74klcR-.js","assets/ProtectedRoute-DOZvoUg3.js"])))=>i.map(i=>d[i]);
import{c as T,r,j as e,u as S,a as z,B as p,L as B,b as E,d as P,e as k,D as A,A as M,T as N,S as V,f as j,I as F,M as J,g as W,P as q,h as G,i as _,k as L,C as H,l as R,m as U,_ as x,H as Y,n as Z,o as K,R as $,p as h,q as Q}from"./vendor-mLxMphKg.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function i(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=i(n);fetch(n.href,o)}})();const X="https://jhhbluhsgqykccyivxei.supabase.co",ee="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpoaGJsdWhzZ3F5a2NjeWl2eGVpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM1Mzk4MTQsImV4cCI6MjA2OTExNTgxNH0.msu84MPP98SnwIwpf1-JsW5DBDllcyKraONJp9TrQ68",g=T(X,ee),O=r.createContext();function te({children:s}){const[t,i]=r.useState(null),[a,n]=r.useState(!0);r.useEffect(()=>{async function c(){const{data:{user:d}}=await g.auth.getUser();if(d){const{data:m}=await g.from("users").select("*").eq("id",d.id).single();i(m)}n(!1)}c()},[]);const o={profile:t,isAdmin:(t==null?void 0:t.is_admin)||!1,loading:a};return e.jsx(O.Provider,{value:o,children:!a&&s})}function se(){return r.useContext(O)}function w({children:s}){const t=S(),i=z(),[a,n]=r.useState(!1),{isAdmin:o}=se(),c=async()=>{await g.auth.signOut(),t("/")},d=()=>{n(!a)},m=[{label:"Events",path:"/events"},{label:"MySignups",path:"/mysignups"}],b=o?[...m,{label:"Admin",path:"/admin"}]:m,y=e.jsx(p,{onClick:d,sx:{textAlign:"center"},children:e.jsxs(B,{children:[b.map(l=>e.jsx(E,{disablePadding:!0,children:e.jsx(P,{sx:{textAlign:"center"},onClick:()=>t(l.path),children:e.jsx(k,{primary:l.label})})},l.label)),e.jsx(A,{}),e.jsx(E,{disablePadding:!0,children:e.jsx(P,{sx:{textAlign:"center"},onClick:c,children:e.jsx(k,{primary:"Logout"})})})]})});return e.jsxs(p,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh",width:"100vw",backgroundColor:"#f4f6f8",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cg fill='%23dce4ec' fill-opacity='1'%3E%3Cpolygon fill-rule='evenodd' points='8 4 12 6 8 8 6 12 4 8 0 6 4 4 6 0 8 4'/%3E%3C/g%3E%3C/svg%3E")`},children:[e.jsx(M,{position:"static",sx:{bgcolor:"white",boxShadow:"none",borderBottom:"1px solid #ddd"},children:e.jsxs(N,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:{xs:"10px",sm:"10px 20px"}},children:[e.jsx(p,{component:"img",src:"https://assets.zyrosite.com/m5KbJakbLpivbpzd/ai-logo-A1aJq39wW9HGqzvO.svg",alt:"Brunel Sailing logo",sx:{height:"40px",cursor:"pointer"},onClick:()=>t("/events")}),e.jsxs(p,{sx:{display:{xs:"none",sm:"flex"},alignItems:"center",gap:1},children:[e.jsx(V,{direction:"row",spacing:1,divider:e.jsx(A,{orientation:"vertical",flexItem:!0,sx:{height:"20px",alignSelf:"center"}}),children:b.map(l=>{const v=i.pathname===l.path;return e.jsx(j,{onClick:()=>t(l.path),sx:{color:v?"primary.main":"black",fontWeight:v?"bold":"normal",backgroundColor:v?"action.hover":"transparent",textTransform:"none","&:hover":{backgroundColor:"action.hover"}},children:l.label},l.label)})}),e.jsx(j,{variant:"outlined",color:"error",onClick:c,sx:{textTransform:"none",ml:2},children:"Logout"})]}),e.jsx(F,{color:"inherit","aria-label":"open drawer",edge:"end",onClick:d,sx:{display:{sm:"none"},color:"black"},children:e.jsx(J,{})})]})}),e.jsx(W,{variant:"temporary",open:a,onClose:d,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:"60%"}},children:y}),e.jsx(p,{component:"main",sx:{flexGrow:1,p:{xs:2,sm:3},width:"100%",display:"flex",justifyContent:"center"},children:e.jsx(q,{elevation:3,sx:{width:"100%",maxWidth:"1200px",backgroundColor:"white",borderRadius:2,p:3},children:s})})]})}const ne="kUIc5Moarxp1c0JtUnPVaATm3eVg3Y1aFGZVNN4L3ZY",re=async s=>{try{const t=await G.get("https://api.unsplash.com/photos/random",{params:{query:s,orientation:"landscape"},headers:{Authorization:`Client-ID ${ne}`}});return t.data&&t.data.urls?t.data.urls.regular:null}catch(t){return console.error("Error fetching image from Unsplash:",t),null}},oe="/SignupForm/assets/BrunelSailingIcon-AP_PaV4P.jpeg";function ie({photographerName:s,photographerUrl:t}){const i="Brunel_Sailing_Signups";return!s||!t?null:e.jsx(p,{sx:{position:"absolute",bottom:8,right:8,backgroundColor:"rgba(0, 0, 0, 0.4)",color:"white",padding:"2px 8px",borderRadius:1,fontSize:"0.75rem"},children:e.jsxs(_,{variant:"caption",children:["Photo by"," ",e.jsx(L,{href:`${t}?utm_source=${i}&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",color:"inherit",children:s})," ","on"," ",e.jsx(L,{href:`https://unsplash.com/?utm_source=${i}&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",color:"inherit",children:"Unsplash"})]})})}const ae=()=>{const[s,t]=r.useState("signin"),[i,a]=r.useState(""),[n,o]=r.useState(""),[c,d]=r.useState(null),[m,b]=r.useState(""),y=S(),[l,v]=r.useState({imageUrl:"",photographerName:"",photographerUrl:""});r.useEffect(()=>{async function f(){const u=await re("sailing race");u&&v(u)}f()},[]);const D=async f=>{if(f.preventDefault(),d(null),b(""),s==="signin"){const{data:u,error:I}=await g.auth.signInWithPassword({email:i,password:n});if(I)d(I.message);else if(u.user){const{data:C}=await g.from("users").select("student_number").eq("id",u.user.id).single();C&&C.student_number?y("/events"):y("/setup")}}else if(s==="signup"){const{error:u}=await g.auth.signUp({email:i,password:n});u?d(u.message):b("Signup successful! Check your email to confirm.")}else if(s==="forgot"){const{error:u}=await g.auth.resetPasswordForEmail(i,{redirectTo:"https://ninzargo.github.io/SignUpForm/#/"});u?d(u.message):b("Password reset email sent! Check your inbox.")}};return e.jsxs(H,{maxWidth:"false",sx:{width:"100vw",height:"100vh",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",backgroundImage:`url(${l.imageUrl})`,backgroundSize:"cover",backgroundPosition:"center",transition:"background-image 1s ease-in-out"},children:[e.jsxs(p,{sx:{p:4,boxShadow:5,borderRadius:2,maxWidth:400,width:"100%",backgroundColor:"rgba(255, 255, 255, 0.95)",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(p,{component:"img",src:oe,alt:"Brunel Sailing Logo",sx:{height:80,width:80,mb:2,borderRadius:"50%"}}),e.jsx(_,{variant:"h4",gutterBottom:!0,children:s==="signup"?"Sign Up":s==="signin"?"Sign In":"Reset Password"}),c&&e.jsx(R,{severity:"error",children:c}),m&&e.jsx(R,{severity:"success",children:m}),e.jsxs("form",{onSubmit:D,children:[e.jsx(U,{fullWidth:!0,label:"Email",variant:"outlined",margin:"normal",value:i,onChange:f=>a(f.target.value),required:!0}),s!=="forgot"&&e.jsx(U,{fullWidth:!0,label:"Password",type:"password",variant:"outlined",margin:"normal",value:n,onChange:f=>o(f.target.value),required:!0}),e.jsx(j,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:s==="signup"?"Sign Up":s==="signin"?"Sign In":"Send Reset Link"})]}),e.jsxs(_,{variant:"body2",sx:{mt:2},children:[s==="signin"&&e.jsxs(e.Fragment,{children:["Don't have an account? ",e.jsx(j,{variant:"text",onClick:()=>t("signup"),children:"Sign Up"}),e.jsx("br",{}),e.jsx(j,{variant:"text",onClick:()=>t("forgot"),children:"Forgot Password?"})]}),s==="signup"&&e.jsxs(e.Fragment,{children:[" Already have an account? ",e.jsx(j,{variant:"text",onClick:()=>t("signin"),children:"Sign In"})," "]}),s==="forgot"&&e.jsxs(e.Fragment,{children:[" Remembered your password? ",e.jsx(j,{variant:"text",onClick:()=>t("signin"),children:"Sign In"})," "]})]})]}),e.jsx(ie,{photographerName:l.photographerName,photographerUrl:l.photographerUrl})]})},le=r.lazy(()=>x(()=>import("./AccountSetup-CXfkDri1.js"),__vite__mapDeps([0,1]))),ce=r.lazy(()=>x(()=>import("./EventList-Cde2Su0H.js"),__vite__mapDeps([2,1]))),de=r.lazy(()=>x(()=>import("./EventSignup-hg9Abliz.js"),__vite__mapDeps([3,1]))),ue=r.lazy(()=>x(()=>import("./MySignups-DJ1IafsB.js"),__vite__mapDeps([4,1]))),pe=r.lazy(()=>x(()=>import("./ResetPassword-Bgs2bUne.js"),__vite__mapDeps([5,1]))),he=r.lazy(()=>x(()=>import("./AccessDenied-Dr3UKXIH.js"),__vite__mapDeps([6,1]))),ge=r.lazy(()=>x(()=>import("./AdminPage-C74klcR-.js"),__vite__mapDeps([7,1]))),xe=r.lazy(()=>x(()=>import("./ProtectedRoute-DOZvoUg3.js"),__vite__mapDeps([8,1])));function me(){const s=S();return r.useEffect(()=>{new URLSearchParams(window.location.hash.substring(1)).has("error_description")&&s("/access-denied");const{data:{subscription:i}}=g.auth.onAuthStateChange((a,n)=>{if(a==="PASSWORD_RECOVERY"){const o=window.location.origin+window.location.pathname;window.history.replaceState({},document.title,o),s("/update-password")}});return()=>{i.unsubscribe()}},[s]),e.jsxs($,{children:[e.jsx(h,{path:"/",element:e.jsx(ae,{})}),e.jsx(h,{path:"/setup",element:e.jsx(le,{})}),e.jsx(h,{path:"/update-password",element:e.jsx(pe,{})}),e.jsx(h,{path:"/access-denied",element:e.jsx(he,{})}),e.jsx(h,{path:"/Events",element:e.jsx(w,{children:e.jsx(ce,{})})}),e.jsx(h,{path:"/signup/:eventId",element:e.jsx(w,{children:e.jsx(de,{})})}),e.jsx(h,{path:"/mysignups",element:e.jsx(w,{children:e.jsx(ue,{})})}),e.jsx(h,{path:"/admin",element:e.jsx(xe,{children:e.jsx(w,{children:e.jsx(ge,{})})})})]})}function fe(){return e.jsxs(Y,{children:[e.jsx(Z,{}),e.jsx(te,{children:e.jsx(r.Suspense,{fallback:e.jsx(p,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(K,{})}),children:e.jsx(me,{})})})]})}Q.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(fe,{})}));export{re as f,g as s,se as u};
