const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AccountSetup-BjRVphhJ.js","assets/vendor-DhX4SPbH.js","assets/EventList-DI4p1Dw4.js","assets/EventSignup-BWBdsfxV.js","assets/MySignups-CjwLydN7.js","assets/ResetPassword-93AEl4nA.js","assets/AccessDenied-DzDzGNGa.js","assets/AdminPage-WVqo0-_g.js","assets/ProtectedRoute-D37DggHW.js"])))=>i.map(i=>d[i]);
import{c as z,r,j as e,u as I,a as M,B as p,L as B,b as E,d as P,e as k,D as A,A as N,T as V,S as F,f as j,I as J,M as W,g as q,P as G,h as H,i as _,k as L,C as Y,l as U,m as R,_ as m,H as Z,n as K,o as $,R as Q,p as h,q as X}from"./vendor-DhX4SPbH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function o(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=o(n);fetch(n.href,a)}})();const ee="https://jhhbluhsgqykccyivxei.supabase.co",te="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpoaGJsdWhzZ3F5a2NjeWl2eGVpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM1Mzk4MTQsImV4cCI6MjA2OTExNTgxNH0.msu84MPP98SnwIwpf1-JsW5DBDllcyKraONJp9TrQ68",g=z(ee,te),O=r.createContext();function se({children:s}){const[t,o]=r.useState(null),[i,n]=r.useState(!0);r.useEffect(()=>{async function c(){const{data:{user:d}}=await g.auth.getUser();if(d){const{data:x}=await g.from("users").select("*").eq("id",d.id).single();o(x)}n(!1)}c()},[]);const a={profile:t,isAdmin:(t==null?void 0:t.is_admin)||!1,loading:i};return e.jsx(O.Provider,{value:a,children:!i&&s})}function ne(){return r.useContext(O)}function w({children:s}){const t=I(),o=M(),[i,n]=r.useState(!1),{isAdmin:a}=ne(),c=async()=>{await g.auth.signOut(),t("/")},d=()=>{n(!i)},x=[{label:"Events",path:"/events"},{label:"MySignups",path:"/mysignups"}],b=a?[...x,{label:"Admin",path:"/admin"}]:x,y=e.jsx(p,{onClick:d,sx:{textAlign:"center"},children:e.jsxs(B,{children:[b.map(l=>e.jsx(E,{disablePadding:!0,children:e.jsx(P,{sx:{textAlign:"center"},onClick:()=>t(l.path),children:e.jsx(k,{primary:l.label})})},l.label)),e.jsx(A,{}),e.jsx(E,{disablePadding:!0,children:e.jsx(P,{sx:{textAlign:"center"},onClick:c,children:e.jsx(k,{primary:"Logout"})})})]})});return e.jsxs(p,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh",width:"100vw",backgroundColor:"#f4f6f8",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cg fill='%23dce4ec' fill-opacity='1'%3E%3Cpolygon fill-rule='evenodd' points='8 4 12 6 8 8 6 12 4 8 0 6 4 4 6 0 8 4'/%3E%3C/g%3E%3C/svg%3E")`},children:[e.jsx(N,{position:"static",sx:{bgcolor:"white",boxShadow:"none",borderBottom:"1px solid #ddd"},children:e.jsxs(V,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:{xs:"10px",sm:"10px 20px"}},children:[e.jsx(p,{component:"img",src:"https://assets.zyrosite.com/m5KbJakbLpivbpzd/ai-logo-A1aJq39wW9HGqzvO.svg",alt:"Brunel Sailing logo",sx:{height:"40px",cursor:"pointer"},onClick:()=>t("/events")}),e.jsxs(p,{sx:{display:{xs:"none",sm:"flex"},alignItems:"center",gap:1},children:[e.jsx(F,{direction:"row",spacing:1,divider:e.jsx(A,{orientation:"vertical",flexItem:!0,sx:{height:"20px",alignSelf:"center"}}),children:b.map(l=>{const v=o.pathname===l.path;return e.jsx(j,{onClick:()=>t(l.path),sx:{color:v?"primary.main":"black",fontWeight:v?"bold":"normal",backgroundColor:v?"action.hover":"transparent",textTransform:"none","&:hover":{backgroundColor:"action.hover"}},children:l.label},l.label)})}),e.jsx(j,{variant:"outlined",color:"error",onClick:c,sx:{textTransform:"none",ml:2},children:"Logout"})]}),e.jsx(J,{color:"inherit","aria-label":"open drawer",edge:"end",onClick:d,sx:{display:{sm:"none"},color:"black"},children:e.jsx(W,{})})]})}),e.jsx(q,{variant:"temporary",open:i,onClose:d,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:"60%"}},children:y}),e.jsx(p,{component:"main",sx:{flexGrow:1,p:{xs:2,sm:3},width:"100%",display:"flex",justifyContent:"center"},children:e.jsx(G,{elevation:3,sx:{width:"100%",maxWidth:"1200px",backgroundColor:"white",borderRadius:2,p:3},children:s})})]})}const re="kUIc5Moarxp1c0JtUnPVaATm3eVg3Y1aFGZVNN4L3ZY",D=async s=>{try{const t=await H.get("https://api.unsplash.com/search/photos",{params:{query:s,per_page:10,orientation:"landscape"},headers:{Authorization:`Client-ID ${re}`}});if(t.data.results&&t.data.results.length>0){const o=Math.floor(Math.random()*t.data.results.length),i=t.data.results[o];return{imageUrl:i.urls.regular,photographerName:i.user.name,photographerUrl:i.user.links.html}}else return await D("sailing event")}catch(t){return console.error("Error fetching image from Unsplash:",t),null}},ae="/assets/BrunelSailingIcon-AP_PaV4P.jpeg";function oe({photographerName:s,photographerUrl:t}){const o="Brunel_Sailing_Signups";return!s||!t?null:e.jsx(p,{sx:{position:"absolute",bottom:8,right:8,backgroundColor:"rgba(0, 0, 0, 0.4)",color:"white",padding:"2px 8px",borderRadius:1,fontSize:"0.75rem"},children:e.jsxs(_,{variant:"caption",children:["Photo by"," ",e.jsx(L,{href:`${t}?utm_source=${o}&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",color:"inherit",children:s})," ","on"," ",e.jsx(L,{href:`https://unsplash.com/?utm_source=${o}&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",color:"inherit",children:"Unsplash"})]})})}const ie=()=>{const[s,t]=r.useState("signin"),[o,i]=r.useState(""),[n,a]=r.useState(""),[c,d]=r.useState(null),[x,b]=r.useState(""),y=I(),[l,v]=r.useState({imageUrl:"",photographerName:"",photographerUrl:""});r.useEffect(()=>{async function f(){const u=await D("sailing race");u&&v(u)}f()},[]);const T=async f=>{if(f.preventDefault(),d(null),b(""),s==="signin"){const{data:u,error:S}=await g.auth.signInWithPassword({email:o,password:n});if(S)d(S.message);else if(u.user){const{data:C}=await g.from("users").select("student_number").eq("id",u.user.id).single();C&&C.student_number?y("/events"):y("/setup")}}else if(s==="signup"){const{error:u}=await g.auth.signUp({email:o,password:n});u?d(u.message):b("Signup successful! Check your email to confirm.")}else if(s==="forgot"){const{error:u}=await g.auth.resetPasswordForEmail(o,{redirectTo:"https://ninzargo.github.io/SignUpForm/#/"});u?d(u.message):b("Password reset email sent! Check your inbox.")}};return e.jsxs(Y,{maxWidth:"false",sx:{width:"100vw",height:"100vh",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",backgroundImage:`url(${l.imageUrl})`,backgroundSize:"cover",backgroundPosition:"center",transition:"background-image 1s ease-in-out"},children:[e.jsxs(p,{sx:{p:4,boxShadow:5,borderRadius:2,maxWidth:400,width:"100%",backgroundColor:"rgba(255, 255, 255, 0.95)",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(p,{component:"img",src:ae,alt:"Brunel Sailing Logo",sx:{height:80,width:80,mb:2,borderRadius:"50%"}}),e.jsx(_,{variant:"h4",gutterBottom:!0,children:s==="signup"?"Sign Up":s==="signin"?"Sign In":"Reset Password"}),c&&e.jsx(U,{severity:"error",children:c}),x&&e.jsx(U,{severity:"success",children:x}),e.jsxs("form",{onSubmit:T,children:[e.jsx(R,{fullWidth:!0,label:"Email",variant:"outlined",margin:"normal",value:o,onChange:f=>i(f.target.value),required:!0}),s!=="forgot"&&e.jsx(R,{fullWidth:!0,label:"Password",type:"password",variant:"outlined",margin:"normal",value:n,onChange:f=>a(f.target.value),required:!0}),e.jsx(j,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:s==="signup"?"Sign Up":s==="signin"?"Sign In":"Send Reset Link"})]}),e.jsxs(_,{variant:"body2",sx:{mt:2},children:[s==="signin"&&e.jsxs(e.Fragment,{children:["Don't have an account? ",e.jsx(j,{variant:"text",onClick:()=>t("signup"),children:"Sign Up"}),e.jsx("br",{}),e.jsx(j,{variant:"text",onClick:()=>t("forgot"),children:"Forgot Password?"})]}),s==="signup"&&e.jsxs(e.Fragment,{children:[" Already have an account? ",e.jsx(j,{variant:"text",onClick:()=>t("signin"),children:"Sign In"})," "]}),s==="forgot"&&e.jsxs(e.Fragment,{children:[" Remembered your password? ",e.jsx(j,{variant:"text",onClick:()=>t("signin"),children:"Sign In"})," "]})]})]}),e.jsx(oe,{photographerName:l.photographerName,photographerUrl:l.photographerUrl})]})},le=r.lazy(()=>m(()=>import("./AccountSetup-BjRVphhJ.js"),__vite__mapDeps([0,1]))),ce=r.lazy(()=>m(()=>import("./EventList-DI4p1Dw4.js"),__vite__mapDeps([2,1]))),de=r.lazy(()=>m(()=>import("./EventSignup-BWBdsfxV.js"),__vite__mapDeps([3,1]))),ue=r.lazy(()=>m(()=>import("./MySignups-CjwLydN7.js"),__vite__mapDeps([4,1]))),pe=r.lazy(()=>m(()=>import("./ResetPassword-93AEl4nA.js"),__vite__mapDeps([5,1]))),he=r.lazy(()=>m(()=>import("./AccessDenied-DzDzGNGa.js"),__vite__mapDeps([6,1]))),ge=r.lazy(()=>m(()=>import("./AdminPage-WVqo0-_g.js"),__vite__mapDeps([7,1]))),me=r.lazy(()=>m(()=>import("./ProtectedRoute-D37DggHW.js"),__vite__mapDeps([8,1])));function xe(){const s=I();return r.useEffect(()=>{new URLSearchParams(window.location.hash.substring(1)).has("error_description")&&s("/access-denied");const{data:{subscription:o}}=g.auth.onAuthStateChange((i,n)=>{if(i==="PASSWORD_RECOVERY"){const a=window.location.origin+window.location.pathname;window.history.replaceState({},document.title,a),s("/update-password")}});return()=>{o.unsubscribe()}},[s]),e.jsxs(Q,{children:[e.jsx(h,{path:"/",element:e.jsx(ie,{})}),e.jsx(h,{path:"/setup",element:e.jsx(le,{})}),e.jsx(h,{path:"/update-password",element:e.jsx(pe,{})}),e.jsx(h,{path:"/access-denied",element:e.jsx(he,{})}),e.jsx(h,{path:"/Events",element:e.jsx(w,{children:e.jsx(ce,{})})}),e.jsx(h,{path:"/signup/:eventId",element:e.jsx(w,{children:e.jsx(de,{})})}),e.jsx(h,{path:"/mysignups",element:e.jsx(w,{children:e.jsx(ue,{})})}),e.jsx(h,{path:"/admin",element:e.jsx(me,{children:e.jsx(w,{children:e.jsx(ge,{})})})})]})}function fe(){return e.jsxs(Z,{children:[e.jsx(K,{}),e.jsx(se,{children:e.jsx(r.Suspense,{fallback:e.jsx(p,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx($,{})}),children:e.jsx(xe,{})})})]})}X.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(fe,{})}));export{D as f,g as s,ne as u};
