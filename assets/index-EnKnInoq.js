const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AccountSetup-Dd3mBQkm.js","assets/vendor-DhX4SPbH.js","assets/EventList-D0j_E9Gl.js","assets/EventSignup-CYSnaGhx.js","assets/MySignups-yFY4PAp4.js","assets/ResetPassword-BVOPNm81.js","assets/AccessDenied-DzDzGNGa.js","assets/AdminPage-BS2VZtpx.js","assets/ProtectedRoute-DPmOCtxz.js"])))=>i.map(i=>d[i]);
import{c as z,r as s,j as e,u as _,a as M,B as g,L as B,b as P,d as E,e as k,D as A,A as N,T as V,S as F,f as y,I as J,M as W,g as q,P as G,h as H,i as S,k as L,C as Y,l as R,m as O,_ as f,H as Z,n as K,o as $,R as Q,p as x,q as X}from"./vendor-DhX4SPbH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();const ee="https://jhhbluhsgqykccyivxei.supabase.co",te="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpoaGJsdWhzZ3F5a2NjeWl2eGVpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM1Mzk4MTQsImV4cCI6MjA2OTExNTgxNH0.msu84MPP98SnwIwpf1-JsW5DBDllcyKraONJp9TrQ68",m=z(ee,te),U=s.createContext();function se({children:n}){const[t,a]=s.useState(null),[i,r]=s.useState(null),[o,c]=s.useState(!0);s.useEffect(()=>{(async()=>{const{data:{session:h}}=await m.auth.getSession();a(h),c(!1);const{data:{subscription:u}}=m.auth.onAuthStateChange((l,b)=>{a(b)});return()=>{u==null||u.unsubscribe()}})()},[]),s.useEffect(()=>{(async()=>{if(t!=null&&t.user){const{data:h,error:u}=await m.from("users").select("*").eq("id",t.user.id).single();u&&console.error("Error fetching user profile:",u),r(h)}else r(null)})()},[t]);const p={session:t,profile:i,isAdmin:(i==null?void 0:i.role)==="Admin",loading:o};return e.jsx(U.Provider,{value:p,children:n})}function ne(){return s.useContext(U)}function w({children:n}){const t=_(),a=M(),[i,r]=s.useState(!1),{isAdmin:o}=ne(),c=async()=>{await m.auth.signOut(),t("/")},p=()=>{r(!i)},j=[{label:"Events",path:"/events"},{label:"MySignups",path:"/mysignups"}],h=o?[...j,{label:"Admin",path:"/admin"}]:j,u=e.jsx(g,{onClick:p,sx:{textAlign:"center"},children:e.jsxs(B,{children:[h.map(l=>e.jsx(P,{disablePadding:!0,children:e.jsx(E,{sx:{textAlign:"center"},onClick:()=>t(l.path),children:e.jsx(k,{primary:l.label})})},l.label)),e.jsx(A,{}),e.jsx(P,{disablePadding:!0,children:e.jsx(E,{sx:{textAlign:"center"},onClick:c,children:e.jsx(k,{primary:"Logout"})})})]})});return e.jsxs(g,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh",width:"100vw",backgroundColor:"#f4f6f8",backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cg fill='%23dce4ec' fill-opacity='1'%3E%3Cpolygon fill-rule='evenodd' points='8 4 12 6 8 8 6 12 4 8 0 6 4 4 6 0 8 4'/%3E%3C/g%3E%3C/svg%3E")`},children:[e.jsx(N,{position:"static",sx:{bgcolor:"white",boxShadow:"none",borderBottom:"1px solid #ddd"},children:e.jsxs(V,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:{xs:"10px",sm:"10px 20px"}},children:[e.jsx(g,{component:"img",src:"https://assets.zyrosite.com/m5KbJakbLpivbpzd/ai-logo-A1aJq39wW9HGqzvO.svg",alt:"Brunel Sailing logo",sx:{height:"40px",cursor:"pointer"},onClick:()=>t("/events")}),e.jsxs(g,{sx:{display:{xs:"none",sm:"flex"},alignItems:"center",gap:1},children:[e.jsx(F,{direction:"row",spacing:1,divider:e.jsx(A,{orientation:"vertical",flexItem:!0,sx:{height:"20px",alignSelf:"center"}}),children:h.map(l=>{const b=a.pathname===l.path;return e.jsx(y,{onClick:()=>t(l.path),sx:{color:b?"primary.main":"black",fontWeight:b?"bold":"normal",backgroundColor:b?"action.hover":"transparent",textTransform:"none","&:hover":{backgroundColor:"action.hover"}},children:l.label},l.label)})}),e.jsx(y,{variant:"outlined",color:"error",onClick:c,sx:{textTransform:"none",ml:2},children:"Logout"})]}),e.jsx(J,{color:"inherit","aria-label":"open drawer",edge:"end",onClick:p,sx:{display:{sm:"none"},color:"black"},children:e.jsx(W,{})})]})}),e.jsx(q,{variant:"temporary",open:i,onClose:p,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:"60%"}},children:u}),e.jsx(g,{component:"main",sx:{flexGrow:1,p:{xs:2,sm:3},width:"100%",display:"flex",justifyContent:"center"},children:e.jsx(G,{elevation:3,sx:{width:"100%",maxWidth:"1200px",backgroundColor:"white",borderRadius:2,p:3},children:n})})]})}const re="kUIc5Moarxp1c0JtUnPVaATm3eVg3Y1aFGZVNN4L3ZY",D=async n=>{try{const t=await H.get("https://api.unsplash.com/search/photos",{params:{query:n,per_page:10,orientation:"landscape"},headers:{Authorization:`Client-ID ${re}`}});if(t.data.results&&t.data.results.length>0){const a=Math.floor(Math.random()*t.data.results.length),i=t.data.results[a];return{imageUrl:i.urls.regular,photographerName:i.user.name,photographerUrl:i.user.links.html}}else return await D("sailing event")}catch(t){return console.error("Error fetching image from Unsplash:",t),null}},oe="/assets/BrunelSailingIcon-AP_PaV4P.jpeg";function ae({photographerName:n,photographerUrl:t}){const a="Brunel_Sailing_Signups";return!n||!t?null:e.jsx(g,{sx:{position:"absolute",bottom:8,right:8,backgroundColor:"rgba(0, 0, 0, 0.4)",color:"white",padding:"2px 8px",borderRadius:1,fontSize:"0.75rem"},children:e.jsxs(S,{variant:"caption",children:["Photo by"," ",e.jsx(L,{href:`${t}?utm_source=${a}&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",color:"inherit",children:n})," ","on"," ",e.jsx(L,{href:`https://unsplash.com/?utm_source=${a}&utm_medium=referral`,target:"_blank",rel:"noopener noreferrer",color:"inherit",children:"Unsplash"})]})})}const ie=()=>{const[n,t]=s.useState("signin"),[a,i]=s.useState(""),[r,o]=s.useState(""),[c,p]=s.useState(null),[j,h]=s.useState(""),u=_(),[l,b]=s.useState({imageUrl:"",photographerName:"",photographerUrl:""});s.useEffect(()=>{async function v(){const d=await D("sailing race");d&&b(d)}v()},[]);const T=async v=>{if(v.preventDefault(),p(null),h(""),n==="signin"){const{data:d,error:I}=await m.auth.signInWithPassword({email:a,password:r});if(I)p(I.message);else if(d.user){const{data:C}=await m.from("users").select("student_number").eq("id",d.user.id).single();C&&C.student_number?u("/events"):u("/setup")}}else if(n==="signup"){const{error:d}=await m.auth.signUp({email:a,password:r});d?p(d.message):h("Signup successful! Check your email to confirm.")}else if(n==="forgot"){const{error:d}=await m.auth.resetPasswordForEmail(a,{redirectTo:"https://ninzargo.github.io/SignUpForm/#/"});d?p(d.message):h("Password reset email sent! Check your inbox.")}};return e.jsxs(Y,{maxWidth:"false",sx:{width:"100vw",height:"100vh",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",backgroundImage:`url(${l.imageUrl})`,backgroundSize:"cover",backgroundPosition:"center",transition:"background-image 1s ease-in-out"},children:[e.jsxs(g,{sx:{p:4,boxShadow:5,borderRadius:2,maxWidth:400,width:"100%",backgroundColor:"rgba(255, 255, 255, 0.95)",display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(g,{component:"img",src:oe,alt:"Brunel Sailing Logo",sx:{height:80,width:80,mb:2,borderRadius:"50%"}}),e.jsx(S,{variant:"h4",gutterBottom:!0,children:n==="signup"?"Sign Up":n==="signin"?"Sign In":"Reset Password"}),c&&e.jsx(R,{severity:"error",children:c}),j&&e.jsx(R,{severity:"success",children:j}),e.jsxs("form",{onSubmit:T,children:[e.jsx(O,{fullWidth:!0,label:"Email",variant:"outlined",margin:"normal",value:a,onChange:v=>i(v.target.value),required:!0}),n!=="forgot"&&e.jsx(O,{fullWidth:!0,label:"Password",type:"password",variant:"outlined",margin:"normal",value:r,onChange:v=>o(v.target.value),required:!0}),e.jsx(y,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},children:n==="signup"?"Sign Up":n==="signin"?"Sign In":"Send Reset Link"})]}),e.jsxs(S,{variant:"body2",sx:{mt:2},children:[n==="signin"&&e.jsxs(e.Fragment,{children:["Don't have an account? ",e.jsx(y,{variant:"text",onClick:()=>t("signup"),children:"Sign Up"}),e.jsx("br",{}),e.jsx(y,{variant:"text",onClick:()=>t("forgot"),children:"Forgot Password?"})]}),n==="signup"&&e.jsxs(e.Fragment,{children:[" Already have an account? ",e.jsx(y,{variant:"text",onClick:()=>t("signin"),children:"Sign In"})," "]}),n==="forgot"&&e.jsxs(e.Fragment,{children:[" Remembered your password? ",e.jsx(y,{variant:"text",onClick:()=>t("signin"),children:"Sign In"})," "]})]})]}),e.jsx(ae,{photographerName:l.photographerName,photographerUrl:l.photographerUrl})]})},le=s.lazy(()=>f(()=>import("./AccountSetup-Dd3mBQkm.js"),__vite__mapDeps([0,1]))),ce=s.lazy(()=>f(()=>import("./EventList-D0j_E9Gl.js"),__vite__mapDeps([2,1]))),ue=s.lazy(()=>f(()=>import("./EventSignup-CYSnaGhx.js"),__vite__mapDeps([3,1]))),de=s.lazy(()=>f(()=>import("./MySignups-yFY4PAp4.js"),__vite__mapDeps([4,1]))),pe=s.lazy(()=>f(()=>import("./ResetPassword-BVOPNm81.js"),__vite__mapDeps([5,1]))),he=s.lazy(()=>f(()=>import("./AccessDenied-DzDzGNGa.js"),__vite__mapDeps([6,1]))),ge=s.lazy(()=>f(()=>import("./AdminPage-BS2VZtpx.js"),__vite__mapDeps([7,1]))),me=s.lazy(()=>f(()=>import("./ProtectedRoute-DPmOCtxz.js"),__vite__mapDeps([8,1])));function xe(){const n=_();return s.useEffect(()=>{new URLSearchParams(window.location.hash.substring(1)).has("error_description")&&n("/access-denied");const{data:{subscription:a}}=m.auth.onAuthStateChange((i,r)=>{if(i==="PASSWORD_RECOVERY"){const o=window.location.origin+window.location.pathname;window.history.replaceState({},document.title,o),n("/update-password")}});return()=>{a.unsubscribe()}},[n]),e.jsxs(Q,{children:[e.jsx(x,{path:"/",element:e.jsx(ie,{})}),e.jsx(x,{path:"/setup",element:e.jsx(le,{})}),e.jsx(x,{path:"/update-password",element:e.jsx(pe,{})}),e.jsx(x,{path:"/access-denied",element:e.jsx(he,{})}),e.jsx(x,{path:"/Events",element:e.jsx(w,{children:e.jsx(ce,{})})}),e.jsx(x,{path:"/signup/:eventId",element:e.jsx(w,{children:e.jsx(ue,{})})}),e.jsx(x,{path:"/mysignups",element:e.jsx(w,{children:e.jsx(de,{})})}),e.jsx(x,{path:"/admin",element:e.jsx(me,{children:e.jsx(w,{children:e.jsx(ge,{})})})})]})}function fe(){return e.jsxs(Z,{children:[e.jsx(K,{}),e.jsx(se,{children:e.jsx(s.Suspense,{fallback:e.jsx(g,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx($,{})}),children:e.jsx(xe,{})})})]})}X.createRoot(document.getElementById("root")).render(e.jsx(s.StrictMode,{children:e.jsx(fe,{})}));export{D as f,m as s,ne as u};
